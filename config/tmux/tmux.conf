# ~/.config/tmux/tmux.conf
# ----------------------------------------------------------
unbind C-b
set -g prefix `
bind ` last-window
bind e send-prefix
set -g mouse on
set -s set-clipboard on

set-option -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",XXX:RGB"
set-option -ga terminal-overrides ",*256col*:RGB"

if-shell '[ "$TERM_PROGRAM" != "Apple_Terminal" ] && \
    [ "$TERM" != "screen" ] && \
    [ "$TERM" != "tmux" ] && \
    [ "$TERM" != "linux" ]' {
      set-environment -g COLORTERM "truecolor"
    }

set -g status-position bottom
set -g status-bg colour234
set -g status-fg colour137
set -g status-left ''
set -g status-right ''
set -g status-right-length 0
set -g status-left-length 0
setw -g mode-keys vi

setw -g window-status-current-format ' #I#[fg=colour250]:#[fg=colour255]#W#[fg=colour50]#F '
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

set -g history-limit 10000
set -g status-interval 5

set -s escape-time 0
set -g base-index 1
setw -g pane-base-index 1

# Copy mode: prefix+[
# Paste: prefix+]
unbind -T copy-mode-vi Enter
bind -T copy-mode-vi 'v' send -X begin-selection
bind -T copy-mode-vi 'V' send -X select-line
bind -T copy-mode-vi 'r' send -X rectangle-toggle

if-shell '[ "$(uname)" = Darwin ]' {
  bind -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'pbcopy'
    bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'pbcopy' \; send -X clear-selection
}

if-shell '[ "$(uname)" = Linux ]' {
  if-shell '[ -n "$WAYLAND_DISPLAY" ]' {
    bind -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'wl-copy'
      bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'wl-copy' \; send -X clear-selection
  }

  if-shell '[ -z "$WAYLAND_DISPLAY" ]' {
    bind -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'xclip -se c -i'
      bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'xclip -se c -i' \; send -X clear-selection
  }

  if-shell 'grep -q Microsoft /proc/version' {
    bind -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'clip.exe'
      bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'clip.exe' \; send -X clear-selection
  }
}

if-shell "uname | grep -q MINGW" {
  bind -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'cat > /dev/clipboard'
    bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe 'cat > /dev/clipboard' \; send -X clear-selection
}

bind-key -n C-S-Left swap-window -t -1\; select-window -t -1
bind-key -n C-S-Right swap-window -t +1\; select-window -t +1

bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

bind -r S-Left resize-pane -L 2
bind -r S-Right resize-pane -R 2
bind -r S-Up resize-pane -U 2
bind -r S-Down resize-pane -D 2

bind-key y set-window-option synchronize-panes
set -g default-shell ${SHELL}

set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none
